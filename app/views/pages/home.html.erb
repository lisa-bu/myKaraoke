<div class="container">
  <%= render "shared/search", playlist: @current_playlist %>
  <div class="stop mb-0">
    <%= link_to new_playlist_playlist_song_path(@current_playlist),
      class: "card-category card-category-recommend" do %>Recommend<% end %>
    <%= link_to playlists_path,
      class: "card-category card-category-playlists" do %>Playlists<% end %>
  </div>
  <div class="stop">
    <%= link_to "Stop & Delete", playlist_path(@current_playlist), data: { turbo_method: :delete, turbo_confirm: "Are you sure?" }, class: "btn btn-info w-100" %>
    <%= link_to "Stop Singing", stop_singing_user_path(current_user), data: { turbo_method: :patch}, class: "btn btn-info w-100" %>
  </div>
  <div class="playlist-container" data-controller="swipe">
    <ul class="playlist-song-list">
    <% if @current_playlist.playlist_songs.count > 0 %>
      <ul class="mt-3">
        <% @current_playlist.playlist_songs.each do |playlist_song| %>
          <li class="d-flex align-items-center"
              data-controller="spotify-player"
              data-spotify-player-uri-value="spotify:track:<%= playlist_song.song.spotify_id %>">
            <%= image_tag playlist_song.song.image_url, class: "img-thumbnail", style: "width: 60px; height: 60px;" %>
            <div class="flex-grow-1 text-center">
              <strong><%= playlist_song.song.name %></strong>
              â€” <%= playlist_song.song.artist %>
            </div>
            <button data-action="click->spotify-player#togglePlay"
              data-spotify-player-target="button"
              style="background: none; border: none; cursor: pointer; padding: 8px;">
              <i class="fa-solid fa-play"
              data-spotify-player-target="icon"
              style="color: #1DB954; font-size: 24px;"></i>
            </button>
            <div data-spotify-player-target="container" hidden></div>
            <i class="fa-solid fa-circle-check" data-action="click->swipe#hide" ></i>
          </li>
        <% end %>
      </ul>
     </ul>
    <% else %>
      <%= image_tag "undraw_playlist_lwhi.svg", alt: "Person wearing headphones", class: "p-3", style: "width: inherit;"%>
    <% end %>
  </div>
  <div class="mt-4" data-controller="spotify" style="display: flex; justify-content: center;">
    <% unless current_user.spotify_access_token %>
      <%= link_to '/auth/spotify',
        method: :post,
        class: "btn spotify-btn w-70 ",
        data: { action: "click->spotify#confirm" } do %>
        <i class="fa-brands fa-spotify fa-2x" style="color: green;"></i>
      <% end %>
    <% end %>
  </div>
</div>
</div>
