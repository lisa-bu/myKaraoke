<div class="home-screen">
  <div class="playlist-container">
    <%= render "shared/search", playlist: @playlist %>
    <%# --- SPOTIFY PLAYLIST MODE --- %>
    <% if @spotify_tracks.present? %>
      <h1 class="playlist-title"><%= @playlist.name %></h1>
      <ul class="playlist-song-list">
        <% @spotify_tracks.each do |track| %>
          <li class="playlist-song-row">
            <div class="playlist-song-text">
              <span class="playlist-song-name"><%= track.name %></span>
              <span class="playlist-song-artist">
                — <%= track.artists.map(&:name).join(", ") %>
              </span>
            </div>
          </li>
        <% end %>
      </ul>
      <%= link_to "Back", playlists_path, class: "btn btn-info mt-3" %>
      <%# STOP — do NOT render local playlist UI %>
      <%# (NO return — just let the block end) %>
    <% else %>
      <%# --- LOCAL PLAYLIST MODE --- %>
      <h1 class="playlist-title"><%= @playlist.name %></h1>
      <ul class="playlist-song-list">
        <% @playlist.playlist_songs.each do |playlist_song| %>
          <li class="playlist-song-row">
            <div class="playlist-song-text">
              <span class="playlist-song-name"><%= playlist_song.song.name %></span>
              <span class="playlist-song-artist">
                — <%= playlist_song.song.artist %>
              </span>
            </div>
          </li>
        <% end %>
      </ul>
      <%= link_to "Make Current Playlist",
          user_path(current_user, current_playlist_id: @playlist.id),
          data: { turbo_method: :patch },
          class: "btn btn-success mt-3" %>
      <%= link_to "Delete", playlist_path(@playlist),
          class: "btn btn-danger top-0 end-0 m-2",
          data: { turbo_method: :delete,
                  turbo_confirm: "Are you sure?" } %>
    <% end %>
    <%= link_to "Back", playlists_path, class: "btn btn-info mt-3" %>
  </div>
</div>
